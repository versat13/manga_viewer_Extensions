# マンガ見開きビューア - Chrome拡張機能

縦一列に並んでいるマンガ画像を見開きで表示する拡張機能です。
マンガサイトでの読書体験を向上させます。
（ノンプログラマーによるバイブコーディング製です）

## インストール方法

1. 以下のファイルを同じフォルダに保存してください：
   - `manifest.json`
   - `content.js` 
   - `popup.html`
   - `popup.js`
   - アイコンファイル3つ（`icon16.png`, `icon48.png`, `icon128.png`）

2. Chromeで `chrome://extensions/` を開きます

3. 右上の「デベロッパーモード」をONにします

4. 「パッケージ化されていない拡張機能を読み込む」ボタンをクリック

5. ファイルを保存したフォルダを選択します

## 基本的な使い方

### 1. ビューアを起動する

マンガが表示されているページで、ブラウザ右上の拡張機能アイコン（本のマーク）をクリックし、「ビューア起動」ボタンを押します。

### 2. ページをめくる

ビューア起動後、以下の方法でページをめくれます：

**マウス操作：**
- 画面左半分をクリック：次のページへ
- 画面右半分をクリック：前のページへ
- マウスホイール上：前のページへ
- マウスホイール下：次のページへ

**キーボード操作：**
- `←`（左矢印）または `スペース`：次のページへ
- `→`（右矢印）：前のページへ
- `↓`（下矢印）：次の1ページだけ送り
- `↑`（上矢印）：前の1ページだけ戻し
- `Esc`：ビューアを閉じる

### 3. ビューア画面の操作ボタン

ビューア起動中、画面の端に以下のボタンが表示されます：

**右上エリア：**
- `×`：ビューアを閉じる
- `全読込`：ページ全体の画像を強制的に読み込む

**右下エリア：**
- `⛶`：フルスクリーン表示の切り替え
- ページ数表示（例：`001/045`）

**左下エリア：**
- `背景：黒` / `背景：白`：背景色の切り替え
- `単` / `見開き`：表示モードの切り替え

**下部中央：**
- ナビゲーションバー（自動で薄くなります）
  - `←次` / `←次`：見開きまたは単ページでの次ページ
  - `←単`：1ページだけ次へ
  - `単→`：1ページだけ前へ
  - `戻→` / `戻→`：見開きまたは単ページでの前ページ
  - プログレスバー：読書進度を表示

## 設定画面の使い方

拡張機能アイコンをクリックすると設定画面が開きます。

### メイン操作
- **ビューア起動**：現在のページでビューアを開始
- **検出テスト**：各方法で何枚の画像が見つかるかテスト実行

### サイト設定
- **ボタン表示**：このサイトで右上に常時起動ボタンを表示
- **ボタン非表示**：起動ボタンを表示しない（拡張機能メニューからのみ起動）

### 画像検出設定

サイトによって画像の配置方法が異なるため、最適な検出方法を選択できます：

- **自動検出**（推奨）：全ての方法を試して最も多く画像が見つかった方法を使用
- **スマート検出**：ブラウザが読み込んだ画像リソースから検出（高速）
- **ディープスキャン**：ページのHTMLソースから画像URLを検索（網羅的）
- **基本型**：ページ上の画像タグを直接検索（軽量）
- **フレーム型**：埋め込まれたフレーム内の画像を検索
- **エリア型**：特定の領域内の画像のみ検索（`.reading-content`等）
- **チャプター型**：チャプター領域内の画像のみ検索
- **リーダー型**：マンガリーダー領域内の画像のみ検索
- **エントリー型**：記事領域内の画像のみ検索
- **Canvasモード**：Canvas要素から画像を抽出（ニコニコ静画等）

### 表示設定
- **単ページ**：1ページずつ表示
- **見開き**：2ページを並べて表示（日本マンガ標準の右→左）

## よくある使用場面と対処法

### 画像が表示されない場合

1. **検出テストを実行**
   - 設定画面で「検出テスト」をクリック
   - 結果を見て画像が見つかっている方法を確認
   - その方法に手動で切り替え

2. **全読込を実行**
   - ビューア右上の「全読込」ボタンをクリック
   - ページ全体を自動スクロールして未読み込み画像を取得

3. **手動での画像読み込み**
   - ビューアを起動する前に、ページを最下部までスクロール
   - 全ての画像が読み込まれてからビューアを起動

### 画像が小さすぎる・大きすぎる場合

- フルスクリーンボタン（`⛶`）でフルスクリーン表示
- 表示モードを「単ページ」と「見開き」で切り替え
- 背景色を変更して見やすさを調整

### ページ送りの動作を変更したい

**見開きモード時：**
- 基本操作（`←`、`→`、クリック）：2ページずつ移動
- 微調整（`↑`、`↓`）：1ページずつ移動

**単ページモード時：**
- 全ての操作で1ページずつ移動

### 特定サイトでうまく動かない

1. 検出モードを「自動検出」以外に変更
2. そのサイトの構造に合った方法を選択：
   - 一般的なマンガサイト：「基本型」または「スマート検出」
   - 埋め込み表示：「フレーム型」
   - 特殊な表示方法：「ディープスキャン」
   - ニコニコ静画：「Canvasモード」

## 対応サイト例

- 一般的なマンガ投稿サイト
- ブログ形式のマンガサイト
- iframe埋め込み型マンガビューア
- Canvas描画型サイト（ニコニコ静画等）
- 各種マンガリーダーアプリ

## トラブルシューティング

### ビューアが起動しない
- ページが完全に読み込まれてから実行
- 他の拡張機能を一時的に無効化して確認
- ページをリロードしてから再試行

### 操作が重い
- 「基本型」検出モードに変更
- 「単ページ」表示に切り替え
- 「全読込」の使用を避ける

### 設定が保存されない
- 拡張機能を再インストール
- Chrome同期が有効になっているか確認

## 注意事項

- この拡張機能は表示方法を変更するのみで、画像のダウンロードや保存は行いません
- サイトの利用規約を遵守してご使用ください
- 一部のサイトでは技術的制限により動作しない場合があります
